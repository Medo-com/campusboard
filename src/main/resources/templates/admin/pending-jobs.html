<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/header :: head}"></head>

<body>

<nav th:replace="~{fragments/header :: header}"></nav>

<div class="container">

    <div class="alert alert-success" th:if="${param.approved}">
        <i class="fas fa-check-circle"></i>
        Job posting approved successfully! It is now visible to students.
    </div>

    <div class="alert alert-success" th:if="${param.rejected}">
        <i class="fas fa-check-circle"></i>
        Job posting rejected. The employer can edit and resubmit it.
    </div>

    <div class="card">
        <div class="card-header">
            <h2><i class="fas fa-clock"></i> Pending Job Approvals</h2>
        </div>
        <p>
            Review job postings submitted by employers.
            Approve quality postings or reject those that don't meet standards.
        </p>
    </div>

    <div th:if="${jobs != null and !jobs.empty}">

        <div class="card" th:each="job : ${jobs}" style="margin-bottom: 2rem;">

            <div class="d-flex justify-between align-center mb-3">
                <h3 style="margin: 0;">
                    <i class="fas fa-briefcase"></i>
                    <span th:text="${job.title}">Job Title</span>
                </h3>
                <span class="badge badge-pending">PENDING</span>
            </div>

            <div style="background: #f8f9fa; padding: 1rem; border-radius: 5px; margin-bottom: 1.5rem;">
                <h4><i class="fas fa-building"></i> Employer Information</h4>

                <p><strong>Posted by:</strong>
                    <span th:text="${job.employer.fullName}">Employer Name</span>
                </p>

                <p><strong>Contact Email:</strong>
                    <a th:href="'mailto:' + ${job.employer.email}"
                       th:text="${job.employer.email}"
                       style="color: #667eea;">
                        employer@example.com
                    </a>
                </p>
            </div>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 1.5rem;">

                <div th:if="${job.location != null}">
                    <h4 style="color: #667eea;"><i class="fas fa-map-marker-alt"></i> Location</h4>
                    <p th:text="${job.location}"></p>
                </div>

                <div th:if="${job.salary != null}">
                    <h4 style="color: #667eea;"><i class="fas fa-dollar-sign"></i> Salary</h4>
                    <p>$<span th:text="${#numbers.formatDecimal(job.salary, 0, 2)}"></span> per hour</p>
                </div>

                <div th:if="${job.category != null}">
                    <h4 style="color: #667eea;"><i class="fas fa-tag"></i> Category</h4>
                    <p th:text="${job.category}"></p>
                </div>

                <div th:if="${job.deadline != null}">
                    <h4 style="color: #667eea;"><i class="fas fa-calendar-alt"></i> Deadline</h4>
                    <p th:text="${job.deadline}"></p>
                </div>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <h4 style="color: #667eea;"><i class="fas fa-align-left"></i> Job Description</h4>
                <div style="padding: 1rem; background: #f8f9fa; border-left: 4px solid #667eea; border-radius: 5px;">
                    <p style="white-space: pre-line;" th:text="${job.description}">
                        Job description here.
                    </p>
                </div>
            </div>

            <div style="color: #999; margin-bottom: 1.5rem;">
                <i class="fas fa-clock"></i> Submitted on:
                <span th:text="${#temporals.format(job.createdAt, 'MMM dd, yyyy HH:mm')}">Date</span>
            </div>

            <div style="border-top: 2px solid #ddd; padding-top: 1.5rem;">
                <h4><i class="fas fa-gavel"></i> Review Decision</h4>

                <div class="d-flex gap-2">

                    <form th:action="@{/admin/jobs/approve/{id}(id=${job.jobId})}"
                          method="post">
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-check"></i> Approve Job
                        </button>
                    </form>

                    <form th:action="@{/admin/jobs/reject/{id}(id=${job.jobId})}"
                          method="post"
                          onsubmit="return confirm('Are you sure you want to reject this job posting?');">
                        <button type="submit" class="btn btn-danger">
                            <i class="fas fa-times"></i> Reject Job
                        </button>
                    </form>
                </div>

                <div class="alert alert-info" style="margin-top:1rem;">
                    <i class="fas fa-info-circle"></i>
                    Approved jobs become visible to students. Rejected jobs can be resubmitted.
                </div>
            </div>

        </div>
    </div>

    <div class="empty-state" th:if="${jobs == null or jobs.empty}">
        <i class="fas fa-check-double"></i>
        <h3>No Pending Approvals</h3>
        <p>All job postings have been reviewed.</p>

        <a th:href="@{/admin/dashboard}" class="btn btn-primary">
            <i class="fas fa-arrow-left"></i> Back to Dashboard
        </a>
    </div>

    <div class="card mt-3" th:if="${jobs != null and !jobs.empty}">
        <h4 style="color: #667eea;">
            <i class="fas fa-clipboard-list"></i> Quick Approval Checklist
        </h4>

        <div style="display:grid; grid-template-columns:1fr 1fr; gap:1rem;">
            <div>
                <p>✓ Clear title & description</p>
                <p>✓ Student-appropriate</p>
                <p>✓ Reasonable compensation</p>
            </div>
            <div>
                <p>✓ Valid contact info</p>
                <p>✓ Policy compliant</p>
                <p>✓ No discriminatory language</p>
            </div>
        </div>
    </div>

</div>

<footer th:replace="~{fragments/footer :: footer}"></footer>

</body>
</html>
