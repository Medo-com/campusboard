<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<!-- ============================================
     STUDENT APPLICATIONS PAGE
     ============================================
     Displays all job applications submitted by the student.
     Shows job info, status badges, and application dates.
     ============================================ -->

<head th:replace="fragments/header :: head"></head>

<body>

<!-- NAVIGATION -->
<nav th:replace="fragments/header :: header"></nav>

<div class="container">

    <!-- SUCCESS MESSAGE -->
    <div class="alert alert-success" th:if="${param.success}">
        <i class="fas fa-check-circle"></i>
        Your application has been submitted successfully!
    </div>

    <!-- PAGE HEADER -->
    <div class="card">
        <div class="card-header">
            <h2>
                <i class="fas fa-file-alt"></i>
                My Applications
            </h2>
        </div>
        <p>
            Track the status of your job applications.
        </p>
    </div>

    <!-- APPLICATIONS TABLE -->
    <div th:if="${applications != null and !applications.empty}">

        <div class="table-wrapper">

            <table class="table">
                <thead>
                <tr>
                    <th><i class="fas fa-hashtag"></i> #</th>
                    <th><i class="fas fa-briefcase"></i> Job Title</th>
                    <th><i class="fas fa-building"></i> Employer</th>
                    <th><i class="fas fa-map-marker-alt"></i> Location</th>
                    <th><i class="fas fa-dollar-sign"></i> Salary</th>
                    <th><i class="fas fa-info-circle"></i> Status</th>
                    <th><i class="fas fa-calendar"></i> Applied On</th>
                </tr>
                </thead>

                <tbody>
                <tr th:each="app, iterStat : ${applications}">

                    <!-- Count -->
                    <td th:text="${iterStat.count}">1</td>

                    <!-- Job Title -->
                    <td>
                        <strong th:text="${app.job.title}">Job Title</strong>
                    </td>

                    <!-- Employer -->
                    <td th:text="${app.job.employer.fullName}">Employer</td>

                    <!-- Location -->
                    <td th:text="${app.job.location != null ? app.job.location : 'N/A'}">Location</td>

                    <!-- Salary -->
                    <td>
                        <span th:if="${app.job.salary != null}">
                            $<span th:text="${#numbers.formatDecimal(app.job.salary, 0, 2)}">0.00</span>/hr
                        </span>
                        <span th:if="${app.job.salary == null}">N/A</span>
                    </td>

                    <!-- STATUS BADGE (FIXED) -->
                    <td>
                        <span class="badge"
                              th:classappend="${
                                app.status == T(com.campusboard.campusboard.models.JobApplication.Status).SUBMITTED
                                  ? 'badge-submitted'
                                  : (app.status == T(com.campusboard.campusboard.models.JobApplication.Status).ACCEPTED
                                      ? 'badge-approved'
                                      : 'badge-rejected')
                              }"
                              th:text="${app.status}">
                        </span>
                    </td>

                    <!-- DATE -->
                    <td>
                        <span th:text="${#temporals.format(app.appliedAt, 'MMM dd, yyyy')}">
                            Jan 01, 2025
                        </span>
                    </td>

                </tr>
                </tbody>
            </table>

        </div>

        <!-- STATUS LEGEND -->
        <div class="card mt-3">
            <h4 style="margin-bottom: 1rem;">
                <i class="fas fa-info-circle"></i> Status Legend
            </h4>

            <div style="display: flex; gap: 2rem; flex-wrap: wrap;">
                <div>
                    <span class="badge badge-submitted">SUBMITTED</span>
                    <span style="margin-left: 0.5rem;">- Under review</span>
                </div>
                <div>
                    <span class="badge badge-approved">ACCEPTED</span>
                    <span style="margin-left: 0.5rem;">- Congratulations!</span>
                </div>
                <div>
                    <span class="badge badge-rejected">REJECTED</span>
                    <span style="margin-left: 0.5rem;">- Not selected</span>
                </div>
            </div>
        </div>

    </div>

    <!-- EMPTY STATE -->
    <div class="empty-state" th:if="${applications == null or applications.empty}">
        <i class="fas fa-inbox"></i>
        <h3>No Applications Yet</h3>
        <p>You haven't applied to any jobs yet.</p>

        <a th:href="@{/student/jobs}" class="btn btn-primary" style="margin-top: 1rem;">
            <i class="fas fa-search"></i> Browse Available Jobs
        </a>
    </div>

</div>

<!-- FOOTER -->
<footer th:replace="fragments/footer :: footer"></footer>

</body>
</html>
