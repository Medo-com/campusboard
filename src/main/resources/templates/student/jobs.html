<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<!-- ============================================
     STUDENT JOBS LISTING PAGE
     ============================================
     This page displays all approved job postings
     that students can browse and apply to.

     Features:
     - Lists all APPROVED jobs from database
     - Shows key job information (title, location, salary, etc.)
     - Provides "View Details" link for each job
     - Displays empty state if no jobs available

     The controller passes a list called "jobs" to this template
     ============================================ -->

<head th:replace="fragments/header :: head">
    <!-- Import head section with CSS and meta tags -->
</head>

<body>
<!-- ============================================
     NAVIGATION BAR
     ============================================ -->
<nav th:replace="fragments/header :: header"></nav>

<!-- ============================================
     MAIN CONTENT CONTAINER
     ============================================ -->
<div class="container">

    <!-- ============================================
         PAGE HEADER
         ============================================ -->
    <div class="card">
        <div class="card-header">
            <h2>
                <i class="fas fa-briefcase"></i>
                Available Job Opportunities
            </h2>
        </div>
        <p>
            Browse through approved job postings from campus employers.
            Click on any job to view full details and apply.
        </p>
    </div>

    <!-- ============================================
         JOB LISTINGS
         ============================================
         Uses Thymeleaf's th:each to loop through jobs list
         Only displays if jobs list is not empty -->

    <!-- Check if there are any jobs to display -->
    <div th:if="${jobs != null and !jobs.empty}">

        <!-- =====================
             LOOP THROUGH EACH JOB
             =====================
             th:each creates a loop, similar to:
             for(Job job : jobs) { ... }

             Each iteration creates a new .job-card div -->
        <div class="job-card" th:each="job : ${jobs}">

            <!-- JOB TITLE -->
            <h3 th:text="${job.title}">Job Title</h3>

            <!-- EMPLOYER NAME -->
            <p style="color: #666; margin-bottom: 1rem;">
                <i class="fas fa-building"></i>
                Posted by:
                <span th:text="${job.employer.fullName}">Employer Name</span>
            </p>

            <!-- =====================
                 JOB METADATA SECTION
                 =====================
                 Displays location, salary, category, and deadline -->
            <div class="job-meta">

                <!-- LOCATION -->
                <div class="job-meta-item" th:if="${job.location != null}">
                    <i class="fas fa-map-marker-alt"></i>
                    <span th:text="${job.location}">Location</span>
                </div>

                <!-- SALARY -->
                <div class="job-meta-item" th:if="${job.salary != null}">
                    <i class="fas fa-dollar-sign"></i>
                    <!-- Format salary with 2 decimal places -->
                    <span th:text="${#numbers.formatDecimal(job.salary, 0, 2)}">0.00</span>
                    /hour
                </div>

                <!-- CATEGORY -->
                <div class="job-meta-item" th:if="${job.category != null}">
                    <i class="fas fa-tag"></i>
                    <span th:text="${job.category}">Category</span>
                </div>

                <!-- APPLICATION DEADLINE -->
                <div class="job-meta-item" th:if="${job.deadline != null}">
                    <i class="fas fa-calendar-alt"></i>
                    Apply by: <span th:text="${job.deadline}">Deadline</span>
                </div>
            </div>

            <!-- =====================
                 JOB DESCRIPTION PREVIEW
                 =====================
                 Shows first 200 characters of description -->
            <div class="job-description">
                <p>
                    <!-- Use substring to show preview (0 to 200 chars max) -->
                    <span th:text="${#strings.length(job.description) > 200
                                         ? #strings.substring(job.description, 0, 200) + '...'
                                         : job.description}">
                            Job description preview will appear here...
                        </span>
                </p>
            </div>

            <!-- =====================
                 VIEW DETAILS BUTTON
                 =====================
                 Links to job details page with jobId parameter -->
            <a th:href="@{/student/jobs/{id}(id=${job.jobId})}"
               class="btn btn-primary">
                <i class="fas fa-info-circle"></i> View Full Details & Apply
            </a>
        </div>
        <!-- End of job loop -->

    </div>

    <!-- ============================================
         EMPTY STATE
         ============================================
         Displayed when no jobs are available
         Uses th:if to check if jobs list is empty or null -->
    <div class="empty-state" th:if="${jobs == null or jobs.empty}">
        <!-- Large icon for empty state -->
        <i class="fas fa-inbox"></i>

        <!-- Message to user -->
        <h3>No Jobs Available</h3>
        <p>
            There are currently no approved job postings.
            Check back later for new opportunities!
        </p>
    </div>

</div>

<!-- ============================================
     FOOTER
     ============================================ -->
<footer th:replace="fragments/footer :: footer"></footer>

</body>
</html>